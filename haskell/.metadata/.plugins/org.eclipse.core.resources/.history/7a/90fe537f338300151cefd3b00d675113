module Robot (robotName, mkRobot, resetName) where

import System.Random (newStdGen, randomRs)
import Data.IORef

newtype Robot = Robot { nameRef :: IORef String }

robotName :: Robot -> IO String
robotName robot = do
  nameR <- nameRef robot
  name <- readIORef nameR
  return name

mkRobot :: IO Robot
mkRobot = do
  name <- newNameRef
  let robot = Robot name
  return robot

resetName :: Robot -> IO ()
resetName robot = do
  name <- newName
  robot = name
  return ()

newNameRef :: IORef String
newNameRef = do
  gen <- newStdGen
  let lettersGen = randomRs ('A', 'Z') gen
      digitsGen = randomRs ('0', '9') gen
      letters = take 2 lettersGen
      digits = take 3 digitsGen
      name = letters ++ digits
  nameR <- newIORef name
  return nameR